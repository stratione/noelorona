---
import BaseLayout from "../layouts/BaseLayout.astro";
import Section from "../components/Section.astro";
import { SITE } from "../consts";
import { profile } from "../data/profile";

const siteUrl = Astro.site ?? new URL(SITE.siteUrl);
const pitch =
  "Advancing technology management through platform engineering, DevSecOps, and applied computing education to connect research, practice, and teaching for secure, scalable delivery, informed by doctoral research on Agile DevSecOps adoption in DoD software programs.";
const highlightSkills = [
  "Platform / Product",
  "Professor",
  "DevOps Advocate",
  "PolÃ­glota"
];
const expertiseCloud = [
  { label: "DevOps", className: "text-2xl" },
  { label: "CI/CD", className: "text-2xl" },
  { label: "Software Delivery", className: "text-2xl" },
  { label: "Platform", className: "text-xl" },
  { label: "Developer Experience", className: "text-xl" },
  { label: "Agile", className: "text-xl" },
  { label: "Lean", className: "text-xl" },
  { label: "Reliability", className: "text-lg" },
  { label: "Security", className: "text-lg" },
  { label: "Automation", className: "text-lg" },
  { label: "Governance", className: "text-lg" },
  { label: "Analytics", className: "text-lg" },
  { label: "Data", className: "text-lg" },
  { label: "Product", className: "text-base" },
  { label: "Strategy", className: "text-base" },
  { label: "Systems", className: "text-base" },
  { label: "Instruction", className: "text-base" },
  { label: "Curriculum", className: "text-base" }
];

const credentialEntries = profile.education.map((item, index) => {
  const hasInstitution = !item.institution.toLowerCase().includes("available upon request");
  return {
    "@type": "EducationalOccupationalCredential",
    "@id": `#degree-${index + 1}`,
    name: item.degree,
    credentialCategory: "Degree",
    recognizedBy: hasInstitution
      ? { "@type": "Organization", name: item.institution }
      : undefined
  };
});

const certificationEntries = profile.certifications.map((name, index) => ({
  "@type": "EducationalOccupationalCredential",
  "@id": `#cert-${index + 1}`,
  name,
  credentialCategory: "Professional Certification"
}));

const structuredData = {
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "Person",
      "@id": "#person",
      name: profile.name,
      jobTitle: profile.title,
      description: profile.summary,
      url: siteUrl.href,
      sameAs: [profile.publications.scholarUrl],
      hasCredential: [
        ...credentialEntries.map((entry) => ({ "@id": entry["@id"] })),
        ...certificationEntries.map((entry) => ({ "@id": entry["@id"] }))
      ]
    },
    ...credentialEntries,
    ...certificationEntries
  ]
};
---
<BaseLayout
  title="Portfolio"
  description="Scholar-practitioner portfolio for Dr. Noe Lorona with expertise in platform engineering, DevSecOps, data platforms, and computing education."
  structuredData={structuredData}
>
  <section id="hero" class="grid gap-8 lg:grid-cols-[1.1fr_0.9fr]">
    <div class="space-y-4 animate-fade-up">
      <p class="text-lg text-marigold">{profile.title}</p>
      <p class="text-lg text-slate">{pitch}</p>
      <div class="flex flex-wrap gap-3">
        <a
          class="rounded-full bg-marigold px-4 py-2 text-sm font-semibold text-parchment shadow-soft animate-soft-bounce"
          href="/talks"
        >
          Talks
        </a>
        <a
          class="rounded-full bg-marigold px-4 py-2 text-sm font-semibold text-parchment shadow-soft animate-soft-bounce"
          href="/publications"
        >
          Publications
        </a>
        <a
          class="rounded-full bg-marigold px-4 py-2 text-sm font-semibold text-parchment shadow-soft animate-soft-bounce"
          href="/contact"
        >
          Contact
        </a>
      </div>
    </div>
    <aside class="rounded-3xl border border-slate/10 bg-haze/80 p-6 shadow-soft animate-fade-up">
      <div class="flex justify-center">
        <img
          src="/images/headshot.jpg"
          alt="Portrait of Dr. Noe Lorona"
          width="100"
          height="100"
          class="soft-portrait h-30 w-30 rounded-full object-cover opacity-90 ring-1 ring-marigold/60"
          loading="eager"
          decoding="async"
        />
      </div>
      <p class="mt-4 text-sm text-slate">{highlightSkills.join(" - ")}</p>
    </aside>
  </section>

  <section id="about" class="scroll-mt-24 py-10">
    <div class="grid gap-4">
      <article id="expertise" class="rounded-2xl border border-slate/10 bg-haze/80 p-6">
        <h3 class="text-lg font-semibold text-ink">Expertise</h3>
        <div class="mt-4 flex flex-wrap gap-3">
          {expertiseCloud.map((skill) => (
            <span
              class={`rounded-full border border-slate/30 px-3 py-1 font-semibold text-ink/90 ${skill.className}`}
            >
              {skill.label}
            </span>
          ))}
        </div>
      </article>
    </div>
  </section>
</BaseLayout>
